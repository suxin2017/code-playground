{"version":3,"sources":["components/CoreEditor/index.module.css","../node_modules/@babel/standalone sync","components/CoreEditor/index.tsx","common/cdn.ts","common/fetch.ts","loader/cdnLoader.ts","common/library.ts","components/JsEditor/index.tsx","parser/jsParser.ts","components/Preview/index.tsx","components/CssEditor/index.tsx","components/HtmlEditor/index.tsx","components/Setting/index.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["module","exports","webpackEmptyContext","req","e","Error","code","keys","resolve","id","CoreEditor","props","value","initValue","language","coreState","React","CodeContext","ref","editorRef","current","model","editor","createModel","Uri","parse","create","automaticLayout","fontSize","lineNumbers","minimap","enabled","onDidChangeModelContent","debounce","onChange","once","getModel","setValue","className","styles","header","style","width","height","then","data","defineTheme","setTheme","getNpmSearchUrl","moduleName","attributes","join","getFileUrl","libraryName","version","path","startsWith","fetchJson","url","a","fetch","res","json","fetchText","text","loadCDNFile","fileContent","loadType","moduleTypeInfo","types","tsDefineds","tsDefault","monaco","typescript","typescriptDefaults","getNodeModulePath","name","getReferenceDependencies","sourceCode","match","foundModules","Set","indexOf","referencePathExtractionPattern","exec","relativePath","console","log","add","Array","from","mapRelativePath","moduleDeclaration","currentPath","base","relative","stack","split","parts","pop","i","length","push","absolute","parseFileForModuleReferences","requirePattern","es6Pattern","es6ImportOnly","addLibraryToRuntime","addExtraLib","uri","file","Library","typs","type","packageJson","this","ts","definiteLib","createLib","definitelyTyped","loadTypeDefined","getPackageJson","rawJson","packageJSON","JSON","rootTypePath","typing","typings","main","replace","loadDepTsDefined","modulePath","getLibPath","getFile","context","getLibContext","importDeps","referDeps","concat","map","dep","endsWith","depTypeLib","getFileNodeModulePath","libType","oldLibrary","JsEditor","LibraryContext","library","languages","setCompilerOptions","allowJs","jsx","JsxEmit","esModuleInterop","target","ScriptTarget","ES2016","allowNonTsExtensions","moduleResolution","ModuleResolutionKind","NodeJs","ModuleKind","CommonJS","typeRoots","allowSyntheticDefaultImports","jsLib","t","reduce","b","Object","forEach","lib","js","currentCode","getValue","dispatch","importReg","Preview","playground","setPlayground","coreContext","dll","output","transform","resultCode","p1","p2","getCompileSrc","html","libs","systemLibrary","imports","f","cssLib","item","css","global","stringify","s","URL","createObjectURL","Blob","revokeObjectURL","src","CssEditor","HtmlEditor","Setting","currentCssLib","setCurrentCssLib","currentJsLibName","setCurrentJsLibName","currentJsLibPath","setCurrentJsLibPath","visible","title","footer","onCancel","color","placeholder","dataSource","renderItem","Item","onClick","splice","setCssLib","Group","v","setGlobal","key","findIndex","setJsLib","ReactGridLayout","WidthProvider","RGL","CodeReducer","state","action","newState","codeState","window","history","pushState","getD","p","initState","createContext","location","search","slice","App","useReducer","useState","setVisiblw","x","y","w","h","static","config","useEffect","d","error","Provider","display","args","flexGrow","layout","margin","cols","rowHeight","innerWidth","padding","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.5718fb73.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"CoreEditor_header__2wdbN\",\"editor\":\"CoreEditor_editor__3dPuI\"};","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 396;","import * as React from \"react\";\nimport { editor, languages, Uri } from \"monaco-editor\";\nimport { debounce } from \"lodash\";\nimport styles from \"./index.module.css\";\nimport SettingIcon from \"./icon/setting.svg\";\nimport { CodeContext } from \"../../App\";\n\nimport(\"monaco-themes/themes/Night Owl.json\").then((data) => {\n  // @ts-ignore\n  editor.defineTheme(\"N\", data);\n  editor.setTheme(\"N\");\n});\n\nexport interface ICoreEditorProps {\n  initValue: string;\n  language: string;\n  value?:string;\n  onChange?: (instance: editor.IStandaloneCodeEditor) => void;\n  onSettingClick?: ()=>void;\n}\n\nexport function CoreEditor(props: ICoreEditorProps) {\n  const { value,initValue, language } = props;\n  const coreState = React.useContext(CodeContext);\n  const ref = React.useRef<HTMLDivElement>(null);\n  const editorRef = React.useRef<editor.IStandaloneCodeEditor>();\n\n  React.useEffect(() => {\n    if (ref.current && !editorRef.current) {\n      const model = editor.createModel(\n        initValue,\n        language,\n        Uri.parse(`file:///main.${language === 'typescript' ? 'tsx' : language}`)\n      );\n      editorRef.current = editor.create(ref.current!, {\n        // value: initValue,\n        language: language,\n        automaticLayout: true,\n        fontSize: 16,\n        lineNumbers: \"off\",\n        minimap: {\n          enabled: false,\n        },\n        model,\n      });\n      editorRef.current.onDidChangeModelContent(\n        debounce(function (e) {\n          props?.onChange?.(editorRef.current!);\n        }, 2000)\n      );\n    }\n  }, []);\n\n  React.useEffect(()=>{\n    if(value && coreState.coreState.once){\n      editorRef.current?.getModel()?.setValue(value);\n    }\n  },[coreState.coreState.once])\n\n  return (\n    <div className={styles.editor}>\n      <div className={styles.header}>\n        <span>{language}</span>\n      \n      </div>\n      <div\n        ref={ref}\n        style={{ width: \"100%\", height: \"calc(100% - 24px)\" }}\n      ></div>\n    </div>\n  );\n}\n","export const getNpmSearchUrl = (moduleName: string, attributes?: string[]) =>\n  `https://ofcncog2cu-dsn.algolia.net/1/indexes/npm-search/${moduleName}?${\n    attributes ? `attributes=${attributes?.join(\",\")}` : \"\"\n  }&x-algolia-agent=Algolia%20for%20vanilla%20JavaScript%20(lite)%203.27.1&x-algolia-application-id=OFCNCOG2CU&x-algolia-api-key=f54e21fa3a2a0160595bb058179bfb1e`;\n\nexport const CDN_URL = `https://data.jsdelivr.com/v1/package/npm/`;\n\nexport const getFileUrl = (\n  libraryName: string,\n  version?: string,\n  path?: string\n) =>\n  `https://cdn.jsdelivr.net/npm/${libraryName}${version ? \"@\" + version : \"\"}${\n    path ? (path?.startsWith(\"/\") ? path : \"/\" + path) : \"\"\n  }`;\n\nexport const getNpmVersionUrl = (libraryName: string) =>\n  `${CDN_URL}${libraryName}`;\n\nexport const getFileInfoUrl = (libraryName: string, version: string) =>\n  `${CDN_URL}${libraryName}${version && \"@\" + version}`;\n","export async function fetchJson<T>(url:string){\n    const res = await fetch(url);\n    return await res.json() as Promise<T>;\n}\n\nexport async function fetchText(url:string){\n    const res = await fetch(url);\n    return await res.text();\n}","import {\n  getNpmVersionUrl,\n  getFileInfoUrl,\n  getFileUrl,\n  getNpmSearchUrl,\n} from \"../common/cdn\";\nimport { fetchJson, fetchText } from \"../common/fetch\";\nimport { DefinitelyType, FileInfo, IncludedType } from \"../types\";\n\nexport async function loadDefaultVersion(libraryName: string) {\n  const version = await fetchJson<{\n    tags: { latest: string; next: string };\n    versions: string[];\n  }>(getNpmVersionUrl(libraryName));\n  return version?.tags?.latest;\n}\n\nexport async function loadPackageCdnFiles(\n  libraryName: string,\n  version: string\n) {\n  const packageInfo = await fetchJson<FileInfo>(\n    getFileInfoUrl(libraryName, version)\n  );\n  return packageInfo;\n}\n\nexport async function loadDefaultPackageFiles(libraryName: string) {\n  const lastVersion = await loadDefaultVersion(libraryName);\n  const filesInfo = await loadPackageCdnFiles(libraryName, lastVersion);\n  return filesInfo;\n}\n\nexport async function loadNpmPackageInfo(libraryName: string) {\n  const npmPackageInfo = await fetchJson(getNpmSearchUrl(libraryName));\n  return npmPackageInfo;\n}\n\nexport async function loadCDNFile(\n  libraryName: string,\n  version?: string,\n  path?: string\n) {\n  const fileContent = await fetchText(getFileUrl(libraryName, version, path));\n  return fileContent;\n}\n\nexport function loadCDNURL(\n  libraryName: string,\n  version?: string,\n  path?: string\n) {\n  return getFileUrl(libraryName, version, path);\n}\n\nexport async function loadType(moduleName: string) {\n  const moduleTypeInfo = await fetchJson<IncludedType | DefinitelyType>(\n    getNpmSearchUrl(moduleName, [\"types\"])\n  );\n\n  return moduleTypeInfo.types;\n}\n","import * as monaco from \"monaco-editor\";\nimport { loadCDNFile, loadType } from \"../loader/cdnLoader\";\n\nexport const tsDefineds: string[] = [];\n\nexport const tsDefault = monaco.languages.typescript.typescriptDefaults;\n\nexport const getNodeModulePath = (name: string, path: string) =>\n  `node_modules/${name}/${path}`;\nexport const getFileNodeModulePath = (name: string, path: string) =>\n  `file:///${getNodeModulePath(name, path)}`;\n\nconst getReferenceDependencies = (sourceCode: string, path: string) => {\n  const foundModules = new Set<string>();\n  var match;\n  if (sourceCode.indexOf(\"reference path\") > 0) {\n    // https://regex101.com/r/DaOegw/1\n    const referencePathExtractionPattern = /<reference path=\"(.*)\" \\/>/gm;\n    while ((match = referencePathExtractionPattern.exec(sourceCode)) !== null) {\n      const relativePath = match[1];\n      if (relativePath) {\n        console.log(relativePath, path);\n        foundModules.add(\n          relativePath.startsWith(\".\") ? relativePath : \"./\" + relativePath\n        );\n      }\n    }\n  }\n  return Array.from(foundModules);\n};\n\n//** A really dumb version of path.resolve */\nconst mapRelativePath = (moduleDeclaration: string, currentPath: string) => {\n  // https://stackoverflow.com/questions/14780350/convert-relative-path-to-absolute-using-javascript\n  function absolute(base: string, relative: string) {\n    if (!base) return relative;\n\n    const stack = base.split(\"/\");\n    const parts = relative.split(\"/\");\n    stack.pop(); // remove current file name (or empty string)\n\n    for (var i = 0; i < parts.length; i++) {\n      if (parts[i] == \".\") continue;\n      if (parts[i] == \"..\") stack.pop();\n      else stack.push(parts[i]);\n    }\n    return stack.join(\"/\");\n  }\n\n  return absolute(currentPath, moduleDeclaration);\n};\n\nconst parseFileForModuleReferences = (sourceCode: string) => {\n  // https://regex101.com/r/Jxa3KX/4\n  const requirePattern = /(const|let|var)(.|\\n)*? require\\(('|\")(.*)('|\")\\);?$/gm;\n  // this handle ths 'from' imports  https://regex101.com/r/hdEpzO/4\n  const es6Pattern = /(import|export)((?!from)(?!require)(.|\\n))*?(from|require\\()\\s?('|\")(.*)('|\")\\)?;?$/gm;\n  // https://regex101.com/r/hdEpzO/8\n  const es6ImportOnly = /import\\s+?\\(?('|\")(.*)('|\")\\)?;?/gm;\n\n  const foundModules = new Set<string>();\n  var match;\n\n  while ((match = es6Pattern.exec(sourceCode)) !== null) {\n    if (match[6]) foundModules.add(match[6]);\n  }\n\n  while ((match = requirePattern.exec(sourceCode)) !== null) {\n    if (match[5]) foundModules.add(match[5]);\n  }\n\n  while ((match = es6ImportOnly.exec(sourceCode)) !== null) {\n    if (match[2]) foundModules.add(match[2]);\n  }\n\n  return Array.from(foundModules);\n};\n\n// 添加动态库\nfunction addLibraryToRuntime(code: string, path: string) {\n  console.log(\"添加类型\", path);\n  tsDefault.addExtraLib(code, path);\n  const uri = monaco.Uri.file(path);\n  if (monaco.editor.getModel(uri) === null) {\n    monaco.editor.createModel(code, \"typescript\", uri);\n  }\n}\n\ntype LibraryType =\n  | {\n      ts: \"included\";\n    }\n  | {\n      ts: \"definitely-typed\";\n      definitelyTyped: string;\n    };\nexport class Library {\n  type: LibraryType;\n  name: string;\n  version?: string;\n  packageJson?: string;\n\n  constructor(name: string, typs: LibraryType, version?: string) {\n    this.name = name;\n    this.type = typs;\n    this.version = version;\n  }\n\n  static async createLib(name: string, version?: string) {\n    let libType: LibraryType = { ts: \"included\" };\n    if (!name.startsWith(\"@types\")) {\n      libType = await loadType(name);\n    }\n\n    return new Library(name, libType, version);\n  }\n\n  async loadTypeDefined() {\n    // 由于外部定义的类型\n    if (this.type?.ts === \"definitely-typed\") {\n      const definiteLib = Library.createLib(this.type.definitelyTyped);\n      (await definiteLib).loadTypeDefined();\n    } else {\n      const rawJson = await this.getPackageJson();\n      const packageJSON = JSON.parse(rawJson);\n      // non-inferred route\n      let rootTypePath =\n        packageJSON.typing || packageJSON.typings || packageJSON.types;\n\n      // package main is custom\n      if (\n        !rootTypePath &&\n        typeof packageJSON.main === \"string\" &&\n        packageJSON.main.indexOf(\".js\") > 0\n      ) {\n        rootTypePath = packageJSON.main.replace(/js$/, \"d.ts\");\n      }\n\n      // Final fallback, to have got here it must have passed in algolia\n      if (!rootTypePath || rootTypePath === \"index\") {\n        rootTypePath = \"index.d.ts\";\n      }\n\n      await this.loadDepTsDefined(rootTypePath);\n    }\n  }\n  async getFile(path: string) {\n    return await loadCDNFile(this.name, this.version, path);\n  }\n  async loadDepTsDefined(currentPath: string) {\n    const modulePath = this.getLibPath(currentPath);\n\n    if (tsDefineds.indexOf(modulePath) !== -1) {\n      return;\n    }\n    tsDefineds.push(modulePath);\n    const context = await this.getFile(currentPath);\n    const tsContext = this.getLibContext(context);\n    addLibraryToRuntime(tsContext, modulePath);\n\n    let importDeps = parseFileForModuleReferences(context);\n    let referDeps = getReferenceDependencies(context, currentPath);\n    importDeps.concat(referDeps).map(async (dep) => {\n      const isRelative = dep.startsWith(\".\");\n      if (isRelative) {\n        const relativePath = mapRelativePath(dep, currentPath);\n        console.log(relativePath);\n        const path = relativePath.endsWith(\".d.ts\")\n          ? relativePath\n          : relativePath + \".d.ts\";\n\n        await this.loadDepTsDefined(path);\n      } else {\n        const depTypeLib = Library.createLib(dep);\n        (await depTypeLib).loadTypeDefined();\n      }\n    });\n  }\n\n  getLibPath(path: string) {\n    if (this.name.startsWith(\"@types\")) {\n      return getFileNodeModulePath(this.name, path);\n    }\n    return getNodeModulePath(this.name, path);\n  }\n\n  getLibContext(context: string) {\n    if (this.name.startsWith(\"@types\")) {\n      return context;\n    }\n    return context;\n    // return `declare module \"${this.name}\" { ${context} }`;\n  }\n\n  async getPackageJson() {\n    if (!this.packageJson) {\n      const packageJson = await loadCDNFile(\n        this.name,\n        this.version,\n        \"package.json\"\n      );\n      this.packageJson = packageJson;\n      addLibraryToRuntime(packageJson, this.getLibPath(\"package.json\"));\n    }\n    return this.packageJson!;\n  }\n}\n","import * as React from \"react\";\nimport { editor, languages } from \"monaco-editor\";\nimport { CodeContext, LibraryContext } from \"../../App\";\nimport { CoreEditor } from \"../CoreEditor\";\nimport { Library, tsDefault } from \"../../common/library\";\nexport interface IJsEditorProps {\n  jsLib:any[]\n}\nlet oldLibrary: string[] = [];\nexport function JsEditor(props: IJsEditorProps) {\n  const coreState = React.useContext(CodeContext);\n  const { library } = React.useContext(LibraryContext);\n\n  React.useEffect(() => {\n    languages.typescript.typescriptDefaults.setCompilerOptions({\n      allowJs:true,\n      jsx:languages.typescript.JsxEmit.React,\n      esModuleInterop: true,\n      target: languages.typescript.ScriptTarget.ES2016,\n      allowNonTsExtensions: true,\n      moduleResolution: languages.typescript.ModuleResolutionKind.NodeJs,\n      module: languages.typescript.ModuleKind.CommonJS,\n      typeRoots: [\"node_modules/@types\"],\n      allowSyntheticDefaultImports: true,\n    });\n\n  }, []);\n\n  React.useEffect(() => {\n    if (props.jsLib) {\n      let t =  props.jsLib.reduce((a,b)=>{\n        return [...a,Object.keys(b)[0]]\n      },[])\n      t.forEach(async (lib: string) => {\n        if (oldLibrary.indexOf(lib) === -1) {\n          (await Library.createLib(lib)).loadTypeDefined();\n          console.log('加载',lib)\n        }\n      });\n      oldLibrary = t;\n    }\n  }, [props.jsLib]);\n  return (\n    <CoreEditor\n      initValue={\"\"}\n      value={coreState.coreState.js}\n      language=\"typescript\"\n      onChange={(editor) => {\n        const currentCode = editor.getValue();\n        coreState?.dispatch?.({\n          type: \"js\",\n          code: currentCode,\n        });\n      }}\n    ></CoreEditor>\n  );\n}\n","import {transform} from '@babel/standalone';\n\nconst importReg = /import\\s*([{\\sa-z_A-Z0-9\\s,}]*?)\\s+from\\s*([\"'a-zA-Z0-9\\-'\"]*);?/g;\n\nexport function getCompileSrc(code: string) {\n  try {\n    const output = transform(code,{\n      \"presets\": [\"react\"]\n    })\n    let module = 0;\n    const resultCode = output.code?.replace(importReg, (match, p1, p2) => {\n      module += 1;\n      return [\n        `const module_${module} = await System.import(${p2});`,\n        `console.log(module_${module})`,\n        `const ${p1} = module_${module}.default ? module_${module}.default : module_${module}`,\n      ].join(\"\\n\");\n    });\n    console.log(\"result\", resultCode);\n    return resultCode;\n  } catch (e) {\n    console.log(e);\n  }\n}\n","import * as React from \"react\";\nimport { CodeContext, LibraryContext } from \"../../App\";\nimport { getFileUrl } from \"../../common/cdn\";\nimport { loadCDNURL, loadDefaultVersion } from \"../../loader/cdnLoader\";\nimport { getCompileSrc } from \"../../parser/jsParser\";\nexport interface IPreviewProps {\n  cssLib: string[];\n  jsLib: any[];\n  global: boolean;\n}\n\nexport function Preview(props: IPreviewProps) {\n  const [playground, setPlayground] = React.useState(\"\");\n  const coreContext = React.useContext(CodeContext);\n  const { library } = React.useContext(LibraryContext);\n\n  React.useEffect(() => {\n\n    let dll = getCompileSrc(coreContext.coreState.js);\n\n    const systemjs = `<script src=\"https://cdn.jsdelivr.net/npm/systemjs@6.8.3/dist/system.min.js\"></script>`;\n    const html = coreContext.coreState.html;\n    let libs = props.jsLib.reduce((a, b) => {\n      return { ...a, ...b };\n    }, {});\n    // let libs = library.reduce((a, b) => {\n    //   a[b] = loadCDNURL(b);\n    //   return a;\n    // }, {} as any);\n    console.log(libs, \"libs\");\n    const systemLibrary = {\n      imports: {\n        ...libs,\n      },\n    };\n    const f = `\n    <html>\n        <head>\n        ${props.cssLib.map((item) => {\n          return `<link rel=\"stylesheet\" href=\"${item}\" crossorigin=\"anonymous\"></link>`;\n        })}\n        <!-- 加载systemjs -->\n            ${systemjs}\n\n       \n       \n         \n\n\n        \n    \n    </head>\n    <body>\n        <style>\n        ${coreContext.coreState.css}\n        </style>\n       ${html}\n\n       <!-- 加载依赖 -->\n       ${\n         props.global\n           ? Object.keys(libs).map(\n               (item) =>{\n                 console.log(libs[item],'iii')\n                return `<script type=\"text/javascript\" src=\"${libs[item]}\" crossorigin=\"anonymous\"></script>`\n               }\n             ).join('\\n')\n           : ` <script type=\"systemjs-importmap\">\n             ${JSON.stringify(systemLibrary)}\n             </script>`\n       }\n       <script>\n       // core runner\n           async function run() {\n               ${dll}\n           }\n           run();\n       </script>\n    </body>\n    \n    \n    </html>`;\n    const s = URL.createObjectURL(new Blob([f], { type: \"text/html\" }));\n    setPlayground(s);\n    return () => {\n      URL.revokeObjectURL(s);\n    };\n  }, [coreContext, library, props.cssLib]);\n  return (\n    <div     style={{ width: \"100%\", height: \"100%\" }}>\n      <iframe\n        src={playground}\n        style={{ width: \"100%\", height: \"100%\" }}\n      ></iframe>\n    </div>\n  );\n}\n","import * as React from \"react\";\nimport { CodeContext } from \"../../App\";\nimport { CoreEditor } from \"../CoreEditor\";\nexport interface ICssEditorProps {}\n\nexport function CssEditor(props: ICssEditorProps) {\n  const coreState = React.useContext(CodeContext)\n  return (\n    <CoreEditor\n      initValue={\"\"}\n      value={coreState.coreState.css}\n      language=\"css\"\n      onChange={(editor) => {\n        const currentCode = editor.getValue();\n        coreState.dispatch({\n          type: \"css\",\n          code: currentCode,\n        });\n      }}\n    ></CoreEditor>\n  );\n}\n","import * as React from \"react\";\nimport { CodeContext } from \"../../App\";\nimport { CoreEditor } from \"../CoreEditor\";\nexport interface IHtmlEditorProps {}\n\nexport function HtmlEditor(props: IHtmlEditorProps) {\n  const coreState = React.useContext(CodeContext)\n  return (\n      <CoreEditor initValue={''} \n      value={coreState.coreState.html}\n      language='html' onChange={editor=>{\n        const currentCode = editor.getValue();\n        coreState.dispatch({\n          type:'html',\n          code:currentCode\n        })\n      }}></CoreEditor>\n  );\n}\n","import { Button, Input, List, Modal, Radio } from \"antd\";\nimport * as React from \"react\";\nimport { LibraryContext } from \"../../App\";\n\nexport interface ISettingProps {\n  cssLib: string[];\n  setCssLib: React.Dispatch<React.SetStateAction<string[]>>;\n  jsLib: any[];\n  setJsLib: React.Dispatch<React.SetStateAction<any[]>>;\n  global: boolean;\n  setGlobal: React.Dispatch<React.SetStateAction<boolean>>;\n  open?: boolean;\n  onCancel?: ()=>void;\n  type?: 'css' | 'js' | 'html',\n  visible:boolean\n}\n\n\nexport function Setting(props: ISettingProps) {\n  const [currentCssLib, setCurrentCssLib] = React.useState(\"\");\n  const [currentJsLibName, setCurrentJsLibName] = React.useState(\"\");\n  const [currentJsLibPath, setCurrentJsLibPath] = React.useState(\"\");\n  const { dispatch } = React.useContext(LibraryContext);\n  const { type = 'css' } = props;\n  const title = {\n    js: 'js 设置',\n    css: 'css 设置',\n    html: 'html 设置'\n  }\n  return (\n    <Modal visible={props.visible} title={title[type]} footer={null} onCancel={()=>{\n      props?.onCancel?.()\n    }}>\n      <div style={{ color: \"#fff\" }}>\n        <div>\n          <div>\n            <Input\n              placeholder={\"样式\"}\n              value={currentCssLib}\n              onChange={(e) => setCurrentCssLib(e.target.value)}\n            ></Input>\n          </div>\n          <div>\n            <List\n              dataSource={props.cssLib}\n              renderItem={item => {\n                return<>\n                 <List.Item>\n                  {item}\n                </List.Item>\n                 <Button\n                 onClick={() => {\n                   const i = props.cssLib.indexOf(item);\n                   props.cssLib.splice(i, 1);\n                   props.setCssLib([\n                     ...props.cssLib,\n                   ]);\n                 }}\n               >\n                 删除\n             </Button>\n             </>\n              }}\n            />\n          </div>\n          <Button\n            onClick={() => {\n              props.setCssLib([...props.cssLib, currentCssLib]);\n            }}\n          >\n            添加样式\n        </Button>\n        </div>\n        <div>\n          <div>添加依赖</div>\n\n          <Radio.Group value={props.global} onChange={(e) => {\n            let v = e.target.value;\n            console.log('v',v)\n            props.setGlobal(v);\n          }}>\n            <Radio value={true}>\b全局引入</Radio>\n            <Radio value={false}>模块引入</Radio>\n          </Radio.Group>\n          <div>\n            <Input\n              placeholder=\"模块名\"\n              value={currentJsLibName}\n              onChange={(e) => setCurrentJsLibName(e.target.value)}\n            />\n            <Input\n              placeholder=\"模块umd路径\"\n              value={currentJsLibPath}\n              onChange={(e) => setCurrentJsLibPath(e.target.value)}\n            />\n          </div>\n          <List\n            dataSource={props.jsLib}\n            renderItem={item => {\n              let key = Object.keys(item)[0] as string;\n              return <List.Item>\n                {key}:{item[key]}\n                <Button\n                  onClick={() => {\n                    const i = props.jsLib.findIndex(i => i[key] != null);\n                    props.jsLib.splice(i, 1);\n                    props.setJsLib([\n                      ...props.jsLib,\n                    ]);\n                  }}\n                >\n                  删除\n              </Button>\n              </List.Item>\n            }}\n          />\n          <Button\n            onClick={() => {\n              props.setJsLib([\n                ...props.jsLib,\n                { [currentJsLibName]: currentJsLibPath },\n              ]);\n            }}\n          >\n            添加依赖\n        </Button>\n        </div>\n      </div>\n    </Modal >\n\n  );\n}\n","import React from \"react\";\nimport logo from \"./logo.svg\";\nimport \"./App.css\";\nimport { JsEditor } from \"./components/JsEditor\";\nimport { Preview } from \"./components/Preview\";\nimport { CssEditor } from \"./components/CssEditor\";\nimport \"react-grid-layout/css/styles.css\";\nimport RGL, { WidthProvider } from \"react-grid-layout\";\nimport { HtmlEditor } from \"./components/HtmlEditor\";\nimport { parse, stringify } from \"qs\";\nimport { Setting } from \"./components/Setting\";\nimport 'antd/dist/antd.dark.css'; \n\nconst ReactGridLayout = WidthProvider(RGL);\n\ntype CodeState = {\n  js: string;\n  css: string;\n  html: string;\n  once: boolean;\n};\n\nconst CodeReducer = (\n  state: CodeState,\n  action: {\n    type: \"css\" | \"js\" | \"html\" | \"all\";\n    code: string;\n    codeState?: CodeState;\n  }\n) => {\n  let newState = state;\n  switch (action.type) {\n    case \"css\":\n      newState = { ...state, css: action.code };\n      break;\n    case \"js\":\n      newState = { ...state, js: action.code };\n      break;\n    case \"html\":\n      newState = { ...state, html: action.code };\n      break;\n    default:\n      if (action.codeState) {\n        newState = action.codeState;\n      }\n  }\n  window.history.pushState(null, \"\", \"?\" + stringify({ ...getD(),p: newState }));\n  return newState;\n};\n\nconst initState: CodeState = {\n  js: \"\",\n  css: \"\",\n  html: \"\",\n  once: false,\n};\n\nexport const CodeContext = React.createContext<{\n  coreState: CodeState;\n  dispatch: React.Dispatch<{\n    type: \"css\" | \"js\" | \"html\" | \"all\";\n    code: string;\n    codeState?: CodeState;\n  }>;\n}>({ coreState: initState, dispatch: () => {} });\n\nexport const LibraryContext = React.createContext<{\n  library: string[];\n  dispatch: React.Dispatch<{\n    type: \"add\" | \"delete\";\n    moduleName: string;\n  }>;\n}>({ library: [], dispatch: () => {} });\n\nconst LibararyReducer = (\n  library: string[],\n  action: { type: \"add\" | \"delete\"; moduleName: string }\n) => {\n  const { moduleName } = action;\n  let hasExist = library.indexOf(moduleName) !== -1;\n  switch (action.type) {\n    case \"add\":\n      if (hasExist) {\n        return library;\n      }\n      return [...library, action.moduleName];\n    case \"delete\":\n      if (hasExist) {\n        library.splice(library.indexOf(moduleName), 1);\n        return [...library];\n      }\n      return library;\n  }\n};\n\nfunction getD() {\n  const data = window.location.search;\n  const d: any = parse(data.slice(1));\n  return d;\n}\nfunction App() {\n  const [coreState, dispatch] = React.useReducer(CodeReducer, initState);\n  const [cssLib, setCssLib] = React.useState([] as string[]);\n  const [jsLib, setJsLib] = React.useState([] as any[]);\n  const [global,setGlobal] = React.useState(false);\n  const [visible,setVisiblw] = React.useState(false);\n  const [config, setConfig] = React.useState([\n    { i: \"css\", x: 0, y: 0, w: 4, h: 6, static: true },\n    { i: \"js\", x: 0, y: 0, w: 4, h: 6, static: true },\n    { i: \"html\", x: 0, y: 6, w: 4, h: 6, static: true },\n    { i: \"preview\", x: 4, y: 0, w: 8, h: 18, static: true },\n  ]);\n\n  React.useEffect(() => {\n    const data = window.location.search;\n    if (data) {\n      try {\n        const d: any = parse(data.slice(1));\n        dispatch({\n          type: \"all\",\n          code: \"\",\n          codeState: { ...d.p,once:true},\n        });\n        console.log(d)\n        if(d.cssLib){\n          setCssLib(d.cssLib);\n        }\n        if(d.jsLib){\n\n          setJsLib(d.jsLib);\n        }\n        if(d.global != null){\n          if(d.global === 'false'){\n            setGlobal(false)\n          }else{\n            setGlobal(true)\n          }\n        }\n      } catch (e) {\n        console.error(\"json\", e);\n      }\n    }\n  }, []);\n  return (\n    <CodeContext.Provider\n      value={{\n        coreState,\n        dispatch,\n      }}\n    >\n      <header className=\"playground-header\">\n        <div className=\"playground-header-title\">Code Playground</div>\n        <span className=\"setting\" onClick={()=>{\n          setVisiblw(true);\n        }}></span>\n      </header>\n      <div style={{ display: \"flex\" }}>\n        <Setting\n        visible={visible}\n        onCancel={()=>{\n          setVisiblw(false)\n        }}\n          cssLib={cssLib}\n          setCssLib={(args) => {\n            window.history.pushState(null, \"\", \"?\" + stringify({ ...getD(),cssLib:args }));\n            setCssLib(args);\n          }}\n          global={global}\n          setGlobal={(args)=>{\n            window.history.pushState(null,\"\",\"?\"+stringify({...getD(),global:args}))\n            setGlobal(args)\n          }}\n          jsLib={jsLib}\n          setJsLib={(args) => {\n            window.history.pushState(null, \"\", \"?\" + stringify({ ...getD(),jsLib:args }));\n            setJsLib(args);\n          }}\n        ></Setting>\n        <div style={{ flexGrow: 1 }}>\n          <ReactGridLayout\n            layout={config}\n            className=\"layout\"\n            margin={[10, 20]}\n            cols={12}\n            rowHeight={30}\n            width={window.innerWidth}\n          >\n            <div key=\"html\">\n              <HtmlEditor />\n            </div>\n            <div key=\"css\">\n              <CssEditor />\n            </div>\n            <div key=\"js\">\n              <JsEditor jsLib={jsLib} />\n            </div>\n            <div key=\"preview\" style={{ padding: \"10px 0 0 0\" }}>\n              <Preview cssLib={cssLib} jsLib={jsLib} global={global}/>\n            </div>\n          </ReactGridLayout>\n        </div>\n      </div>\n      \n    </CodeContext.Provider>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}